<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>Fluent API · Blindsight</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content='docs'/>
<link rel="canonical" href="/blindsight/usage/fluent.html"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:100normal,100italic,300normal,300italic,400normal,400italic,500normal,500italic,700normal,700italic,900normal,900italicc" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../js/page.js"></script>
<script type="text/javascript" src="../js/warnOldVersion.js"></script>
<script type="text/javascript" src="../js/groups.js"></script>
<link rel="stylesheet" type="text/css" href="../lib/foundation/dist/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="../css/page.css"/>

<!--
<link rel="shortcut icon" href="../images/favicon.ico" />
-->
</head>

<body>
<div class="off-canvas-wrapper">
<div class="off-canvas-wrapper-inner" data-off-canvas-wrapper>

<div class="off-canvas position-left" id="off-canvas-menu" data-off-canvas>
<nav class="off-canvas-nav">
<div class="nav-home">
<a href="../index.html" >
<span class="home-icon">⌂</span>Blindsight
</a>
<div class="version-number">
0.1.27
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="../setup/index.html" class="page">Setup</a>
  <ul>
    <li><a href="../setup/logback.html" class="page">Logback</a></li>
    <li><a href="../setup/generic.html" class="page">Generic</a></li>
  </ul></li>
  <li><a href="../usage/index.html" class="page">Usage</a>
  <ul>
    <li><a href="../usage/overview.html" class="page">Overview</a></li>
    <li><a href="../usage/resolvers.html" class="page">Logger Resolvers</a></li>
    <li><a href="../usage/slf4j.html" class="page">SLF4J API</a></li>
    <li><a href="../usage/fluent.html" class="active page">Fluent API</a></li>
    <li><a href="../usage/semantic.html" class="page">Semantic API</a></li>
    <li><a href="../usage/flow.html" class="page">Flow API</a></li>
    <li><a href="../usage/structured.html" class="page">Structured Logging</a></li>
    <li><a href="../usage/conditional.html" class="page">Conditional Logging</a></li>
    <li><a href="../usage/context.html" class="page">Contextual Logging</a></li>
    <li><a href="../usage/sourcecode.html" class="page">Source Code</a></li>
  </ul></li>
  <li><a href="../extending/index.html" class="page">Extending</a>
  <ul>
    <li><a href="../extending/overview.html" class="page">Overview</a></li>
  </ul></li>
</ul>
</div>

</nav>
</div>

<div class="off-canvas-content" data-off-canvas-content>

<header class="site-header expanded row">
<div class="small-12 column">
<a href="#" class="off-canvas-toggle hide-for-medium" data-toggle="off-canvas-menu"><svg class="svg-icon svg-icon-menu" version="1.1" id="Menu" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve"> <path class="svg-icon-menu-path" fill="#53CDEC" d="M16.4,9H3.6C3.048,9,3,9.447,3,10c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,9.447,16.952,9,16.4,9z M16.4,13
H3.6C3.048,13,3,13.447,3,14c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,13.447,16.952,13,16.4,13z M3.6,7H16.4
C16.952,7,17,6.553,17,6c0-0.553-0.048-1-0.6-1H3.6C3.048,5,3,5.447,3,6C3,6.553,3.048,7,3.6,7z"/></svg>
</a>
<div class="title"><a href="../index.html">Blindsight</a></div>

<!--
<a href="https://www.example.com" class="logo show-for-medium">logo</a>
-->
</div>
</header>

<div class="expanded row">

<div class="medium-3 large-2 show-for-medium column">
<nav class="site-nav">
<div class="nav-home">
<a href="../index.html" >
<span class="home-icon">⌂</span>Blindsight
</a>
<div class="version-number">
0.1.27
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="../setup/index.html" class="page">Setup</a>
  <ul>
    <li><a href="../setup/logback.html" class="page">Logback</a></li>
    <li><a href="../setup/generic.html" class="page">Generic</a></li>
  </ul></li>
  <li><a href="../usage/index.html" class="page">Usage</a>
  <ul>
    <li><a href="../usage/overview.html" class="page">Overview</a></li>
    <li><a href="../usage/resolvers.html" class="page">Logger Resolvers</a></li>
    <li><a href="../usage/slf4j.html" class="page">SLF4J API</a></li>
    <li><a href="../usage/fluent.html" class="active page">Fluent API</a></li>
    <li><a href="../usage/semantic.html" class="page">Semantic API</a></li>
    <li><a href="../usage/flow.html" class="page">Flow API</a></li>
    <li><a href="../usage/structured.html" class="page">Structured Logging</a></li>
    <li><a href="../usage/conditional.html" class="page">Conditional Logging</a></li>
    <li><a href="../usage/context.html" class="page">Contextual Logging</a></li>
    <li><a href="../usage/sourcecode.html" class="page">Source Code</a></li>
  </ul></li>
  <li><a href="../extending/index.html" class="page">Extending</a>
  <ul>
    <li><a href="../extending/overview.html" class="page">Overview</a></li>
  </ul></li>
</ul>
</div>

</nav>
</div>

<div class="small-12 medium-9 large-10 column">
<section class="site-content">

<span id="version-warning"></span>

<div class="page-header row">
<div class="medium-12 show-for-medium column">
<div class="nav-breadcrumbs">
<ul>
  <li><a href="../index.html">Blindsight</a></li>
  <li><a href="../usage/index.html">Usage</a></li>
  <li>Fluent API</li>
</ul>
</div>
</div>
</div>

<div class="page-content row">
<div class="small-12 large-9 column" id="docs">
<h1><a href="#fluent-api" name="fluent-api" class="anchor"><span class="anchor-link"></span></a>Fluent API</h1>
<p>A <a href="https://www.martinfowler.com/bliki/FluentInterface.html">fluent builder interface</a> is an API that relies heavily on method chaining to build up an expression. The Blindsight fluent API works with <a href="/blindsight/api/com/tersesystems/blindsight/api/Markers.html" title="com.tersesystems.blindsight.api.Markers"><code>Markers</code></a>, <a href="/blindsight/api/com/tersesystems/blindsight/api/Message.html" title="com.tersesystems.blindsight.api.Message"><code>Message</code></a>, and <a href="/blindsight/api/com/tersesystems/blindsight/api/Arguments.html" title="com.tersesystems.blindsight.api.Arguments"><code>Arguments</code></a>, and uses type classes to map appropriately, using the <a href="/blindsight/api/com/tersesystems/blindsight/api/ToMarkers.html" title="com.tersesystems.blindsight.api.ToMarkers"><code>ToMarkers</code></a>, <a href="/blindsight/api/com/tersesystems/blindsight/api/ToMessage.html" title="com.tersesystems.blindsight.api.ToMessage"><code>ToMessage</code></a> and <a href="/blindsight/api/com/tersesystems/blindsight/api/ToArguments.html" title="com.tersesystems.blindsight.api.ToArguments"><code>ToArguments</code></a> type classes, respectively. </p>
<p>The fluent API has an immediate advantage in that there&rsquo;s less overloading in the API, and there&rsquo;s more room to chain. With type classes, it&rsquo;s possible to set up much richer <a href="https://tersesystems.com/blog/2020/03/10/a-taxonomy-of-logging/">structured logging</a>.</p>
<h2><a href="#accessing-fluent-logger" name="accessing-fluent-logger" class="anchor"><span class="anchor-link"></span></a>Accessing Fluent Logger</h2>
<p>The easiest way of getting a fluent logger is to use the <a href="/blindsight/api/com/tersesystems/blindsight/LoggerFactory.html" title="com.tersesystems.blindsight.LoggerFactory"><code>LoggerFactory</code></a> and then call the <code>fluent</code> method:</p>
<pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/tersesystems/blindsight/tree/v0.1.27/docs/src/test/scala/example/fluent/FluentMain.scala#L54-L57" target="_blank" title="Go to snippet source"></a><code class="language-scala">import com.tersesystems.blindsight.fluent.FluentLogger

val logger                     = com.tersesystems.blindsight.LoggerFactory.getLogger(getClass)
val fluentLogger: FluentLogger = logger.fluent</code></pre>
<p>The fluent logger builds up the logging statement by calling <code>marker</code>, <code>argument</code>, <code>message</code>, <code>cause</code>, and then finally <code>log()</code> or <code>logWithPlaceholders()</code> to execute the statement. You may call each of these methods repeatedly, and they build up markers, arguments, or a concatenated message (note that exceptions are, well, an exception). You may call them in any order. If you call <code>log()</code> then the statement is executed exactly as written. If you call <code>logWithPlaceholders()</code> then the number of arguments is counted and &ldquo;{}&rdquo; format placeholders are appended to the statement&rsquo;s message so that all arguments are visible.</p>
<pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/tersesystems/blindsight/tree/v0.1.27/docs/src/test/scala/example/fluent/FluentMain.scala#L71-L77" target="_blank" title="Go to snippet source"></a><code class="language-scala">fluentLogger.info
  .marker(someMarker)
  .message(&quot;some message {}&quot;)
  .argument(args)
  .message(&quot;exception {}&quot;)
  .cause(exception)
  .log()</code></pre>
<h2><a href="#markers" name="markers" class="anchor"><span class="anchor-link"></span></a>Markers</h2>
<p>You can log with a marker alone and then log:</p>
<pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/tersesystems/blindsight/tree/v0.1.27/docs/src/test/scala/example/fluent/FluentMain.scala#L61-L64" target="_blank" title="Go to snippet source"></a><code class="language-scala">import net.logstash.logback.marker.{Markers =&gt; LogstashMarkers}
val someMarker = LogstashMarkers.append(&quot;user&quot;, &quot;will&quot;)

fluentLogger.info.marker(someMarker).log()</code></pre>
<p>This will write out an empty string as the message, and a logstash marker.</p>
<p>You can also write out anything that has a <a href="/blindsight/api/com/tersesystems/blindsight/api/ToMarkers.html" title="com.tersesystems.blindsight.api.ToMarkers"><code>ToMarkers</code></a> implementation, i.e. the Logstash implicits lets you do this:</p>
<pre class="prettyprint"><code class="language-scala">import com.tersesystems.blindsight.logstash.Implicits._
import com.tersesystems.blindsight.api._

// Shown explicitly here but this is all in Implicits._
implicit def arrayToMarkers[T]: ToMarkers[(String, Seq[T])] = ToMarkers {
  case (k, v) =&gt; Markers(LogstashMarkers.appendArray(k, v: _*))
}

fluentLogger.marker(&quot;array&quot; -&gt; Seq(&quot;one&quot;, &quot;two&quot;, &quot;three&quot;)).log()
</code></pre>
<p>All markers are in a <a href="/blindsight/api/com/tersesystems/blindsight/api/Markers.html" title="com.tersesystems.blindsight.api.Markers"><code>Markers</code></a> instance internally, but are not accessible from the builder.</p>
<h2><a href="#message" name="message" class="anchor"><span class="anchor-link"></span></a>Message</h2>
<p>A message is the part of the statement that is written out as a string. </p>
<pre class="prettyprint"><code class="language-scala">fluentLogger.message(&quot;some message&quot;).log()
</code></pre>
<p>Messages can be concatenated together by calling <code>message</code> repeatedly:</p>
<pre class="prettyprint"><code class="language-scala">fluentLogger.message(&quot;hello&quot;).message(&quot;world&quot;).log()
</code></pre>
<p>You can pass in your own custom instances, of course.</p>
<pre class="prettyprint"><code class="language-scala">case class Person(name: String)

implicit val personToMessage: ToMessage[Person] = ToMessage { person =&gt;
  Message(s&quot;My name is ${person.name}&quot;)
}
fluentLogger.message(person).log()
</code></pre>
<h2><a href="#arguments" name="arguments" class="anchor"><span class="anchor-link"></span></a>Arguments</h2>
<p>Arguments can be added with <code>argument</code>. You do not need to define a message, but you should call <code>logWithPlaceholders</code> in that case so the argument is visible.</p>
<pre class="prettyprint"><code class="language-scala">fluentLogger.argument(someArgument).logWithPlaceholders()
</code></pre>
<p>Custom formatting is done with <a href="/blindsight/api/com/tersesystems/blindsight/api/ToArguments.html" title="com.tersesystems.blindsight.api.ToArguments"><code>ToArguments</code></a>.</p>
<pre class="prettyprint"><code class="language-scala">case class Person(name: String)

implicit val personToArguments: ToArguments[Person] = ToArguments { person =&gt;
  Arguments(s&quot;${person.name}&quot;)
}

val person = Person(&quot;Felix&quot;)
fluentLogger.message(&quot;I was talking to {}&quot;).argument(person).log()
</code></pre>
<h2><a href="#exceptions" name="exceptions" class="anchor"><span class="anchor-link"></span></a>Exceptions</h2>
<p>Exceptions are added using <code>cause</code>. Exceptions are of type <code>Throwable</code>, just like the SLF4J API.</p>
<pre class="prettyprint"><code class="language-scala">fluentLogger.message(&quot;the exception was {}&quot;).cause(someException).log()
</code></pre>
<p>Technically, an exception is the last argument in a logging statement. Exception does <strong>not</strong> compose, and if you call <code>exception</code> repeatedly, the last exception will be set. </p>
<div class="source-github">
The source code for this page can be found <a href="https://github.com/tersesystems/blindsight/tree/v0.1.27/docs/src/main/paradox/usage/fluent.md">here</a>.
</div>

<div class="nav-next">
<p><strong>Next:</strong> <a href="../usage/semantic.html">Semantic API</a></p>
</div>
</div>
<div class="large-3 show-for-large column" data-sticky-container>
<nav class="sidebar sticky" data-sticky data-anchor="docs" data-sticky-on="large">
<div class="page-nav">
<div class="nav-title">On this page:</div>
<div class="nav-toc">
<ul>
  <li><a href="../usage/fluent.html#fluent-api" class="header">Fluent API</a>
  <ul>
    <li><a href="../usage/fluent.html#accessing-fluent-logger" class="header">Accessing Fluent Logger</a></li>
    <li><a href="../usage/fluent.html#markers" class="header">Markers</a></li>
    <li><a href="../usage/fluent.html#message" class="header">Message</a></li>
    <li><a href="../usage/fluent.html#arguments" class="header">Arguments</a></li>
    <li><a href="../usage/fluent.html#exceptions" class="header">Exceptions</a></li>
  </ul></li>
</ul>
</div>
</div>
</nav>
</div>
</div>

</section>
</div>

</div>

<footer class="site-footer">

<section class="site-footer-nav">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 medium-4 large-3 text-center column">
<div class="nav-links">
<ul>
<!-- <li><a href="https://www.example.com/products/">Products</a> -->
</ul>
</div>
</div>

</div>
</div>
</div>
</section>

<section class="site-footer-base">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 text-center large-9 column">

<!--
<div class="copyright">
<span class="text">&copy; 2020</span>
<a href="https://www.example.com" class="logo">logo</a>
</div>
-->
</div>

</div>
</div>
</div>
</section>
</footer>

</div>
</div>
</div>
</body>

<script type="text/javascript" src="../lib/foundation/dist/foundation.min.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="../js/magellan.js"></script>

<style type="text/css">@import "../lib/prettify/prettify.css";</style>
<script type="text/javascript" src="../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">jQuery(function(){window.prettyPrint && prettyPrint()});</script>
<script type="text/javascript">jQuery(function(jq){initOldVersionWarnings(jq, '0.1.27', 'https://tersesystems.github.io/blindsight')});</script>


</html>
